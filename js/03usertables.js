"use strict";$(function(){var s=1,c=0,d=0;function t(){var a=[];return $(".table tbody tr td input").each(function(t,e){$(".table tbody tr td input").eq(t).prop("checked")&&a.push(t)}),a}!function i(){$.ajax({type:"get",url:"../api/admin.php",data:{mes:"init",num:5,now:s},success:function(t){var e=JSON.parse(t);d=e.total;var a,n="";a=e.group.map(function(t){return'<tr>\n                                <td><input type="checkbox" /></td>\n                                <td>'+t.uid+"</td>\n                                <td >"+t.username+"</td>\n                                <td>"+t.password+'</td>\n                                <td class="center">'+t.email+'</td>\n                                <td>\n                                    <button type="button" class="btn btn-success">修改并保存</button>\n                                    <button type="button" class="btn btn-danger">删除</button>\n                                    <button type="button" class="btn btn-info">Edit</button>\n                                </td>\n                            </tr>'}).join(""),$(".table tbody").html(a),c=Math.ceil(d/5);for(var l=0;l<c;l++)n+='<a tabindex="0" class="fg-button ui-button ui-state-default">'+(l+1)+"</a>";$("#pageall").html(n),$("#pageall a").eq(s-1).addClass("ui-state-disabled").siblings().removeClass("ui-state-disabled"),$("#DataTables_Table_0_next").unbind("click"),$("#DataTables_Table_0_next").click(function(){s!=c&&(s++,i())}),$("#DataTables_Table_0_previous").unbind("click"),$("#DataTables_Table_0_previous").click(function(){1!=s&&(s--,i())}),$("#DataTables_Table_0_first").unbind("click"),$("#DataTables_Table_0_first").click(function(){s=1,i()}),$("#DataTables_Table_0_last").unbind("click"),$("#DataTables_Table_0_last").click(function(){s=c,i()}),$("#pageall").on("click","a",function(){s=$(this).html(),i()}),1==s?($("#DataTables_Table_0_previous").addClass("ui-state-disabled"),$("#DataTables_Table_0_first").addClass("ui-state-disabled")):($("#DataTables_Table_0_previous").removeClass("ui-state-disabled"),$("#DataTables_Table_0_first").removeClass("ui-state-disabled")),s==c?($("#DataTables_Table_0_next").addClass("ui-state-disabled"),$("#DataTables_Table_0_last").addClass("ui-state-disabled")):($("#DataTables_Table_0_next").removeClass("ui-state-disabled"),$("#DataTables_Table_0_last").removeClass("ui-state-disabled"))}})}(),$("#title-checkbox").click(function(){var a=$("#title-checkbox").prop("checked");$(".table tbody tr td input").each(function(t,e){$(".table tbody tr td input").eq(t).prop("checked",a)})}),$(".table").on("click","input",function(){t().length==$(".table tbody tr td input").length?$("#title-checkbox").prop("checked",!0):$("#title-checkbox").prop("checked",!1)}),$("#delall").click(function(){confirm("你确定要删除所选行吗")&&t().reverse().forEach(function(a){new Promise(function(e){$.ajax({url:"../api/user.php",type:"get",data:{mes:"del",uid:$(".table tr").eq(a+1).find("td").eq(1).html()},success:function(t){e(t)}})}).then(function(t){$(".table tr").eq(a+1).remove(),location.reload()})})}),$(".table tbody").on("click",".btn-danger",function(){var t=$(this).parent().parent().children().eq(1).html();confirm("确定要删除吗")&&($.ajax({type:"get",url:"../api/admin.php",data:{uid:t,mes:"del"},success:function(t){}}),$(this).parent().parent().remove())}),$(".table tbody").on("click",".btn-info",function(){var t=$(this).parent().parent().children().eq(1),e=$(this).parent().parent().children().eq(2),a=$(this).parent().parent().children().eq(3),n=$(this).parent().parent().children().eq(4);e.attr("contenteditable",!0).focus(),a.attr("contenteditable",!0),n.attr("contenteditable",!0),$(this).prev().prev().click(function(){$.ajax({type:"get",url:"../api/admin.php",data:{uid:t.html(),username:e.html(),password:a.html(),email:n.html(),mes:"update"},success:function(t){console.log(t),"yes"==t&&(alert("修改成功"),e.attr("contenteditable",!1),a.attr("contenteditable",!1),n.attr("contenteditable",!1))}})})})});