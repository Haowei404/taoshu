"use strict";$(function(){$("#header #site-nav").load("site-nav.html"),$("#footer").load("min-footer.html");var i=function(i){return/^[a-zA-Z][a-zA-Z0-9_]{4,15}$/.test(i)},s=function(i){return/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(i)},t=function(i){return/^\w{6,16}$/.test(i)},e=["../img/VerifyCodeImage1.aspx","../img/VerifyCodeImage2.aspx","../img/VerifyCodeImage3.aspx","../img/VerifyCodeImage4.aspx","../img/VerifyCodeImage5.aspx"],n=["46b4","chin","sn8b","26b9","p6gh"],a=void 0,r=0;function l(){a=randomNum(0,4),$(".codeimg img").attr("src",e[a])}l(),$("#imgVerifyCode").click(function(){l()}),$(".changeCodeimg").click(function(){l()}),$(".field input").focus(function(){$(this).parent().addClass("active"),$(this).parent().find(".tips").css("display","inline-block"),$(this).parent().find(".error").css("display","none")}),$(".field input").blur(function(){var e=this;$(this).parent().removeClass("active"),$(this).parent().find(".tips").css("display","none"),$(this).parent().find(".ok").css("display","none"),$(this).val().trim()?(0==$(this).parent().index()&&(i($(this).val())?$.ajax({url:"../api/user.php",type:"get",data:{mes:"checkusername",username:$(".field input").eq(0).val()},success:function(i){console.log(i),"no"==i?$(e).parent().find(".ok").css("display","block"):$(e).parent().find(".error").css("display","block").children().html("该用户名已被注册")}}):$(this).parent().find(".error").css("display","block").children().html("用户名在5-20字符内")),1==$(this).parent().index()&&(s($(this).val())?$.ajax({url:"../api/user.php",type:"get",data:{mes:"checkemail",email:$(this).val()},success:function(i){"yes"==i?$(e).parent().find(".error").css("display","block").children().html("该邮箱已经被注册"):$(e).parent().find(".ok").css("display","block")}}):$(this).parent().find(".error").css("display","block").children().html("请输入您有效的电子邮箱地址")),2==$(this).parent().index()&&(t($(this).val())?$(this).parent().find(".ok").css("display","block"):$(this).parent().find(".error").css("display","block").children().html("密码长度6-16个字符之间")),3==$(this).parent().index()&&($(this).val()==$(this).parent().prev().find("input").val()&&$(this).parent().prev().find("input").val().trim()?$(this).parent().find(".ok").css("display","block"):$(this).parent().find(".error").css("display","block").children().html("两次输入的密码不匹配")),4==$(this).parent().index()&&($(this).val()==n[a]?$(this).parent().find(".ok").css("display","block"):$(this).parent().find(".error").css("display","block").children().html("验证码验证错误"))):$(this).parent().find(".error").css("display","block").children().html("输入不能为空")}),$("#btn-register").click(function(){for(var i=r=0;i<5;i++)"block"==$(".field .ok").eq(i).css("display")&&r++;if(5==r){$.ajax({url:"../api/user.php",type:"post",data:{mes:"add",username:$(".field input").eq(0).val(),password:$(".field input").eq(2).val(),email:$(".field input").eq(1).val()},success:function(i){var e=JSON.parse(i);console.log(e[0],1,e[0].uid),setCookie("uid",e[0].uid)}}),setCookie("username",$(".field input").eq(0).val());$("#footer").css("display","none"),$("#right").css("display","none"),$(".registerform").html('<div ><h2 style="text-align:center;">注册成功，5秒后跳转到主页</h2></div>'),setTimeout(function(){location.href="index.html"},5e3)}else alert("请填写正确信息")})});